---
# tasks file for bertvv.squirrelmail

- include_vars: "{{ item }}"
  with_first_found:
    - "{{ ansible_distribution }}.yml"
    - "{{ ansible_os_family }}.yml"
  tags: squirrelmail

- name: Install package repository
  package:
    name: "{{ squirremail_repository }}"
    state: installed
  tags: squirrelmail

- name: Install packages
  package:
    name: "{{ item }}"
    state: installed
  with_items: "{{ squirremail_packages }}"
  tags: squirrelmail  

- name: Install Squirrelmail configuration
  template:
    src: squirrelmail.conf.j2
    dest: /usr/share/squirrelmail/config/config.php
  notify: restart httpd
  tags: squirrelmail

- name: Create symlink to squirrelmail
  file: 
    src: /usr/share/squirrelmail 
    dest: /var/www/squirrelmail 
    state: link 
    force: yes
  notify: restart httpd
